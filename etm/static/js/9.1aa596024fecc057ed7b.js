webpackJsonp([9],{"8Bcy":function(e,t){},"YI/J":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("LHK4"),o=s("av1y"),c=s("DfFo"),i=s("OUwZ"),n={components:{Page:a.a,NoData:o.a,SSecret:c.a},data:function(){return{selectRecord:[],PageTotal:1,routeName:"",showPop:!1,tableData:[],totalVoters:0,ONE_PAGE_NUM:10,cancelVote:[],voteType:"",submitVote:!1,secondSecret:"",showPop1:!1}},computed:{yesOrNo:function(){return"成功"===this.voteType?"success-tip":"fail-tip"}},mounted:function(){this._getRecord(0),this.cancelVote.length?this.$refs.voteBtn.disabled=!1:this.$refs.voteBtn.disabled=!0},methods:{_getRecord:function(e){var t=this;this.$http.get("/api/accounts/delegates",{params:{address:Object(i.a)(localStorage.getItem("etmsecret")||sessionStorage.getItem("etmsecret"))}}).then(function(s){s.data.success&&(t.totalVoters=s.data.delegates.length,t.tableData=s.data.delegates.slice(t.ONE_PAGE_NUM*e,t.ONE_PAGE_NUM*e+10),t.PageTotal=Math.ceil(s.data.delegates.length/t.ONE_PAGE_NUM))}).catch(function(e){console.log(e)})},submitVoter:function(){this.showPop=!1,Bus.$emit("showMask",!1),this.$store.state.needsSecondSecret?this.showPop1=!0:this._submitVoter()},_submitVoter:function(){var e=this;this.$http.put("/api/accounts/delegates",{secret:localStorage.getItem("etmsecret")||sessionStorage.getItem("etmsecret"),delegates:this.cancelVote,secondSecret:this.secondSecret}).then(function(t){Bus.$emit("showMask",!1),e.showPop=!1,t.data.success?(e.voteType="成功",e.submitVote=!0,setTimeout(function(){e.submitVote=!1},2e3)):(e.voteType="失败",e.submitVote=!0,setTimeout(function(){e.submitVote=!1},2e3))})},deleteVote:function(){this.showPop=!0,Bus.$emit("showMask",!0)},hidePopout:function(){this.showPop=!1,Bus.$emit("showMask",!1)},renderDiff:function(e){this._getRecord(e)},hidePop:function(e){this.showPop1=e},inputSSecret:function(e){this.secondSecret=e,this._submitVoter()}},watch:{selectRecord:function(e,t){var s=this;this.cancelVote=[],e.forEach(function(e){s.cancelVote.push("-"+e.publicKey)}),this.cancelVote.length?this.$refs.voteBtn.disabled=!1:this.$refs.voteBtn.disabled=!0}}},r={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"w"},[s("div",{staticClass:"head flex"},[s("p",[e._v("共"+e._s(e.totalVoters)+"条")]),e._v(" "),s("button",{ref:"voteBtn",on:{click:e.deleteVote}},[e._v("删除")])]),e._v(" "),s("div",{staticClass:"event"},[s("table",{directives:[{name:"show",rawName:"v-show",value:e.tableData.length,expression:"tableData.length"}],attrs:{width:"100%",border:"0",cellspacing:"0",cellpresumeing:"0"}},[e._m(0),e._v(" "),s("tbody",{staticClass:"table_tb"},e._l(e.tableData,function(t,a){return s("tr",{key:a},[s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.selectRecord,expression:"selectRecord"}],attrs:{type:"checkbox"},domProps:{value:t,checked:Array.isArray(e.selectRecord)?e._i(e.selectRecord,t)>-1:e.selectRecord},on:{change:function(s){var a=e.selectRecord,o=s.target,c=!!o.checked;if(Array.isArray(a)){var i=t,n=e._i(a,i);o.checked?n<0&&(e.selectRecord=a.concat([i])):n>-1&&(e.selectRecord=a.slice(0,n).concat(a.slice(n+1)))}else e.selectRecord=c}}})]),e._v(" "),s("td",[e._v(e._s(t.rate))]),e._v(" "),s("td",[e._v(e._s(t.username))]),e._v(" "),s("td",{staticStyle:{color:"#399dff"}},[e._v(e._s(t.address))]),e._v(" "),s("td",[e._v(e._s(t.productivity)+"%")]),e._v(" "),s("td",[e._v(e._s(t.producedblocks))]),e._v(" "),s("td",[e._v(e._s(t.approval)+"%")])])}))]),e._v(" "),s("no-data",{directives:[{name:"show",rawName:"v-show",value:!e.tableData.length,expression:"!tableData.length"}]})],1),e._v(" "),s("page",{directives:[{name:"show",rawName:"v-show",value:e.PageTotal>1,expression:"PageTotal > 1"}],attrs:{PageTotal:e.PageTotal,routeName:e.routeName},on:{renderDiff:e.renderDiff}}),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showPop,expression:"showPop"}],staticClass:"popout"},[s("div",{staticClass:"close"},[s("span",{on:{click:e.hidePopout}},[e._v("×")])]),e._v(" "),s("p",{staticClass:"title"},[e._v("取消投票")]),e._v(" "),s("p",{staticClass:"care"},[e._v("请确认您的选择，最多可同时取消33份投票")]),e._v(" "),s("div",{staticClass:"input-list"},e._l(e.selectRecord,function(t,a){return s("div",{key:a,staticClass:"input-line"},[s("div",{staticClass:"input clearfix"},[s("span",{staticClass:"fl"},[e._v(e._s(t.username))]),e._v(" "),s("span",{staticClass:"gre fr"},[e._v(e._s(t.address))])])])})),e._v(" "),s("div",{staticClass:"set-btm"},[s("div",{staticClass:"confirm"},[s("button",{on:{click:e.submitVoter}},[e._v("提交")])]),e._v(" "),s("p",{staticClass:"tips"},[e._v("投票需支付0.01Mole")])])]),e._v(" "),s("s-secret",{directives:[{name:"show",rawName:"v-show",value:e.showPop1,expression:"showPop1"}],on:{hidePop:e.hidePop,inputSSecret:e.inputSSecret}}),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.submitVote,expression:"submitVote"}],staticClass:"tip",class:e.yesOrNo},[e._v("\n\t\t\t删除"+e._s(e.voteType)+"！\n\t\t")])],1)},staticRenderFns:[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("thead",{staticClass:"table_th"},[s("th"),e._v(" "),s("th",[e._v("排名")]),e._v(" "),s("th",[e._v("受托人")]),e._v(" "),s("th",[e._v("地址")]),e._v(" "),s("th",[e._v("生产率")]),e._v(" "),s("th",[e._v("生产块数")]),e._v(" "),s("th",[e._v("得票率")])])}]};var l=s("VU/8")(n,r,!1,function(e){s("8Bcy")},"data-v-d318cec8",null);t.default=l.exports}});
//# sourceMappingURL=9.1aa596024fecc057ed7b.js.map