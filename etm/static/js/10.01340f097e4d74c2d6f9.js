webpackJsonp([10],{"9+r7":function(e,t){},cyCT:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("mvHQ"),n=s.n(i),o=s("//Fk"),a=s.n(o),r=s("LHK4"),c=s("av1y"),l=s("DfFo"),h={components:{Page:r.a,NoData:c.a,SSecret:l.a},data:function(){return{tableData:[],selectMiners:[],PageTotal:1,totalMinersNum:0,ONE_PAGE_NUM:10,showPop:!1,secondSecret:"",miners:[],showSecondSecretPop:!1,voteType:"",submitVote:!1,minerDetail:null}},computed:{yesOrNo:function(){return"成功"===this.voteType?"success-tip":"fail-tip"}},activated:function(){this.$store.commit("changeTitle","选择旷工")},created:function(){this.getMinersNum(),this.getMiners(0)},mounted:function(){this.miners.length?this.$refs.voteBtn.disabled=!1:this.$refs.voteBtn.disabled=!0},updated:function(){var e=this;Bus.$on("hideQrcode",function(t){e.showPop=!1})},methods:{getMinersNum:function(){var e=this;this.$http.get("http://118.24.135.98:4096/api/miner").then(function(t){t.data.success&&(e.totalMinersNum=t.data.totalCount,e.PageTotal=Math.ceil(t.data.totalCount/e.ONE_PAGE_NUM))}).catch(function(e){console.log(e)})},getMiners:function(e){var t=this;this.$http.get("http://118.24.135.98:4096/api/miner",{params:{orderBy:"productivity:desc",offset:this.ONE_PAGE_NUM*e,limit:this.ONE_PAGE_NUM}}).then(function(s){s.data.success&&(t.tableData=s.data.miners,t.tableData.forEach(function(s,i){t.$set(s,"index",t.ONE_PAGE_NUM*e+i)}))}).catch(function(e){console.log(e)})},calcTime:function(e){var t=Math.floor(e/3600),s=Math.floor((e-3600*t)/60);return 0===t?s+"min":t+"h "+s+"min"},vote:function(){this.showPop=!0,Bus.$emit("showMask",!0)},renderDiff:function(e){this.getMiners(e)},hidePopout:function(){this.showPop=!1,Bus.$emit("showMask",!1)},submitVoter:function(){this.showPop=!1,Bus.$emit("showMask",!1),this.$store.state.needsSecondSecret?this.showSecondSecretPop=!0:this._submitVoter()},_submitVoter:function(){var e=this;this.checkSecondSecret(),this.$http.put("http://118.24.135.98:4096/api/miner",{secret:localStorage.getItem("etmsecret")||sessionStorage.getItem("etmsecret"),secondSecret:this.secondSecret,miners:this.miners}).then(function(t){Bus.$emit("showMask",!1),e.showPop=!1,t.data.success?(e.voteType="成功",e.submitVote=!0,setTimeout(function(){e.submitVote=!1},2e3)):(e.voteType="失败",e.submitVote=!0,setTimeout(function(){e.submitVote=!1},2e3))}).catch(function(e){console.log(e)})},checkSecondSecret:function(){this.$store.needsSecondSecret||this.$http.interceptors.request.use(function(e){return delete e.data.secondSecret,e},function(e){return a.a.reject(error)})},goToDetail:function(e){this.$router.push({path:"/select-miners/"+e.minerNo}),sessionStorage.setItem("detailInfo",n()(e))},setMinerDetail:function(e){this.minerDetail=e},hidePop:function(e){this.showSecondSecretPop=e},inputSSecret:function(e){this.secondSecret=e,this._submitVoter()}},watch:{selectMiners:function(e,t){var s=this;this.miners=[],e.forEach(function(e){s.miners.push({minerNo:e.minerNo,vote:e.vote})}),this.miners.length?this.$refs.voteBtn.disabled=!1:this.$refs.voteBtn.disabled=!0},$route:function(e){this.minerDetail=this.$route.params.id,sessionStorage.setItem("minerDetail",this.minerDetail)}}},v={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{directives:[{name:"show",rawName:"v-show",value:void 0==e.minerDetail,expression:"minerDetail == undefined"}],staticClass:"w"},[s("div",{staticClass:"head flex"},[s("p",[e._v("共"+e._s(e.totalMinersNum)+"台")]),e._v(" "),s("button",{ref:"voteBtn",on:{click:e.vote}},[e._v("投票")])]),e._v(" "),s("div",{staticClass:"event"},[s("table",{directives:[{name:"show",rawName:"v-show",value:e.tableData.length,expression:"tableData.length"}],attrs:{width:"100%",border:"0",cellspacing:"0",cellpresumeing:"0"}},[e._m(0),e._v(" "),s("tbody",{staticClass:"table_tb"},e._l(e.tableData,function(t,i){return s("tr",{key:i},[s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.selectMiners,expression:"selectMiners"}],ref:"checkBox",refInFor:!0,attrs:{type:"checkbox"},domProps:{value:t,checked:Array.isArray(e.selectMiners)?e._i(e.selectMiners,t)>-1:e.selectMiners},on:{change:function(s){var i=e.selectMiners,n=s.target,o=!!n.checked;if(Array.isArray(i)){var a=t,r=e._i(i,a);n.checked?r<0&&(e.selectMiners=i.concat([a])):r>-1&&(e.selectMiners=i.slice(0,r).concat(i.slice(r+1)))}else e.selectMiners=o}}})]),e._v(" "),s("td",[e._v(e._s(t.index+1))]),e._v(" "),s("td",{staticClass:"gre",on:{click:function(s){e.goToDetail(t)}}},[e._v(e._s(t.minerName))]),e._v(" "),s("td",[e._v(e._s(t.vote))]),e._v(" "),s("td",[e._v(e._s(t.cheat))]),e._v(" "),s("td",[e._v(e._s((100*t.productivity).toFixed(2))+"%")]),e._v(" "),s("td",[e._v(e._s(t.averagepower.toFixed(2))+" MH/s")]),e._v(" "),s("td",[e._v(e._s(e.calcTime(t.alreadyruntime)))])])}))]),e._v(" "),s("no-data",{directives:[{name:"show",rawName:"v-show",value:!e.tableData.length,expression:"!tableData.length"}]})],1),e._v(" "),s("page",{directives:[{name:"show",rawName:"v-show",value:e.PageTotal>1,expression:"PageTotal > 1"}],attrs:{PageTotal:e.PageTotal},on:{renderDiff:e.renderDiff}}),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showPop,expression:"showPop"}],staticClass:"popout"},[s("div",{staticClass:"close"},[s("span",{on:{click:e.hidePopout}},[e._v("×")])]),e._v(" "),s("p",{staticClass:"title"},[e._v("投票")]),e._v(" "),s("p",{staticClass:"care"},[e._v("请确认您的选择与投票，每张票最多可同时投33人")]),e._v(" "),s("div",{staticClass:"input-list"},e._l(e.selectMiners,function(t,i){return s("div",{key:i,staticClass:"input-line"},[s("div",{staticClass:"input clearfix"},[s("span",{staticClass:"fl"},[e._v(e._s(t.minerName))]),e._v(" "),s("span",{staticClass:"gre fr"},[e._v(e._s(t.vote)+"票")])])])})),e._v(" "),s("div",{staticClass:"set-btm"},[s("div",{staticClass:"confirm"},[s("button",{on:{click:e.submitVoter}},[e._v("提交")])]),e._v(" "),s("p",{staticClass:"tips"},[e._v("投票需支付0.01Mole")])])]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.submitVote,expression:"submitVote"}],staticClass:"tip",class:e.yesOrNo},[e._v("\r\n\t\t  投票"+e._s(e.voteType)+"！\r\n\t  ")]),e._v(" "),s("s-secret",{directives:[{name:"show",rawName:"v-show",value:e.showSecondSecretPop,expression:"showSecondSecretPop"}],on:{hidePop:e.hidePop,inputSSecret:e.inputSSecret}})],1),e._v(" "),s("router-view",{on:{setMinerDetail:e.setMinerDetail}})],1)},staticRenderFns:[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("thead",{staticClass:"table_th"},[s("th"),e._v(" "),s("th",[e._v("排名")]),e._v(" "),s("th",[e._v("名称")]),e._v(" "),s("th",[e._v("得票数")]),e._v(" "),s("th",[e._v("欺诈次数")]),e._v(" "),s("th",[e._v("生产率")]),e._v(" "),s("th",[e._v("平均算力")]),e._v(" "),s("th",[e._v("已运行时间")])])}]};var u=s("VU/8")(h,v,!1,function(e){s("9+r7")},"data-v-b76c50a0",null);t.default=u.exports}});
//# sourceMappingURL=10.01340f097e4d74c2d6f9.js.map